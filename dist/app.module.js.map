{"version":3,"sources":["../src/app.module.ts"],"sourcesContent":["import { CacheModule } from '@nestjs/cache-manager';\nimport { Module } from '@nestjs/common';\nimport { ConditionalModule, ConfigModule } from '@nestjs/config';\nimport { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from '@nestjs/core';\nimport { JwtModule } from '@nestjs/jwt';\nimport { TypeOrmModule } from '@nestjs/typeorm';\nimport { LoggerModule } from 'nestjs-pino';\nimport { CaptchaModule } from '@/shared/captcha';\nimport { ExcelModule } from '@/shared/excel';\nimport { RedisModule } from '@/shared/redis';\n\nimport { EventsModule } from './events';\nimport { DefaultFilter, NotFoundFilter, ValidationFilter } from './filters';\nimport { AuthGuard } from './guards';\nimport {\n  CacheKeyInterceptor,\n  OperLogInterceptor,\n  ResponseInterceptor,\n} from './interceptors';\nimport { IndexModule } from './modules';\nimport {\n  CACHE_OPTIONS,\n  CAPTCHA_OPTIONS,\n  CONFIG_OPTIONS,\n  EXCEL_OPTIONS,\n  JWT_OPTIONS,\n  LOGGER_OPTIONS,\n  REDIS_OPTIONS,\n  TYPEORM_OPTIONS,\n} from './options';\nimport { ValidationPipe } from './pipes';\nimport { QueuesModule } from './queues';\nimport { SharedModule } from './shared';\nimport { SysUtil } from './utils';\n\n@Module({\n  imports: [\n    ConfigModule.forRoot(CONFIG_OPTIONS),\n    LoggerModule.forRootAsync(LOGGER_OPTIONS),\n    TypeOrmModule.forRootAsync(TYPEORM_OPTIONS),\n    JwtModule.registerAsync(JWT_OPTIONS),\n    CacheModule.registerAsync(CACHE_OPTIONS),\n    CaptchaModule.registerAsync(CAPTCHA_OPTIONS),\n    ExcelModule.registerAsync(EXCEL_OPTIONS),\n    RedisModule.registerAsync(REDIS_OPTIONS),\n    ConditionalModule.registerWhen(EventsModule, () => !SysUtil.isTesting),\n    QueuesModule,\n    SharedModule,\n    IndexModule,\n  ],\n  providers: [\n    {\n      provide: APP_GUARD,\n      useClass: AuthGuard,\n    },\n    {\n      provide: APP_INTERCEPTOR,\n      useClass: CacheKeyInterceptor,\n    },\n    {\n      provide: APP_INTERCEPTOR,\n      useClass: ResponseInterceptor,\n    },\n    {\n      provide: APP_INTERCEPTOR,\n      useClass: OperLogInterceptor,\n    },\n    {\n      provide: APP_PIPE,\n      useClass: ValidationPipe,\n    },\n    {\n      provide: APP_FILTER,\n      useClass: ValidationFilter,\n    },\n    {\n      provide: APP_FILTER,\n      useClass: DefaultFilter,\n    },\n    {\n      provide: APP_FILTER,\n      useClass: NotFoundFilter,\n    },\n  ],\n})\nexport class AppModule {}\n"],"names":["AppModule","Module","imports","ConfigModule","forRoot","CONFIG_OPTIONS","LoggerModule","forRootAsync","LOGGER_OPTIONS","TypeOrmModule","TYPEORM_OPTIONS","JwtModule","registerAsync","JWT_OPTIONS","CacheModule","CACHE_OPTIONS","CaptchaModule","CAPTCHA_OPTIONS","ExcelModule","EXCEL_OPTIONS","RedisModule","REDIS_OPTIONS","ConditionalModule","registerWhen","EventsModule","SysUtil","isTesting","QueuesModule","SharedModule","IndexModule","providers","provide","APP_GUARD","useClass","AuthGuard","APP_INTERCEPTOR","CacheKeyInterceptor","ResponseInterceptor","OperLogInterceptor","APP_PIPE","ValidationPipe","APP_FILTER","ValidationFilter","DefaultFilter","NotFoundFilter"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAqFaA;;;eAAAA;;;8BArFe;wBACL;wBACyB;sBACiB;qBACvC;yBACI;4BACD;yBACC;uBACF;uBACA;wBAEC;yBACmC;wBACtC;8BAKnB;yBACqB;yBAUrB;uBACwB;wBACF;wBACA;uBACL;;;;;;;AAoDjB,IAAA,AAAMA,YAAN,MAAMA;AAAW;AAAXA;IAlDZC,IAAAA,cAAM,EAAC;QACNC,SAAS;YACPC,oBAAY,CAACC,OAAO,CAACC,uBAAc;YACnCC,wBAAY,CAACC,YAAY,CAACC,uBAAc;YACxCC,sBAAa,CAACF,YAAY,CAACG,wBAAe;YAC1CC,cAAS,CAACC,aAAa,CAACC,oBAAW;YACnCC,yBAAW,CAACF,aAAa,CAACG,sBAAa;YACvCC,sBAAa,CAACJ,aAAa,CAACK,wBAAe;YAC3CC,kBAAW,CAACN,aAAa,CAACO,sBAAa;YACvCC,kBAAW,CAACR,aAAa,CAACS,sBAAa;YACvCC,yBAAiB,CAACC,YAAY,CAACC,oBAAY,EAAE,IAAM,CAACC,cAAO,CAACC,SAAS;YACrEC,oBAAY;YACZC,oBAAY;YACZC,oBAAW;SACZ;QACDC,WAAW;YACT;gBACEC,SAASC,eAAS;gBAClBC,UAAUC,iBAAS;YACrB;YACA;gBACEH,SAASI,qBAAe;gBACxBF,UAAUG,iCAAmB;YAC/B;YACA;gBACEL,SAASI,qBAAe;gBACxBF,UAAUI,iCAAmB;YAC/B;YACA;gBACEN,SAASI,qBAAe;gBACxBF,UAAUK,gCAAkB;YAC9B;YACA;gBACEP,SAASQ,cAAQ;gBACjBN,UAAUO,qBAAc;YAC1B;YACA;gBACET,SAASU,gBAAU;gBACnBR,UAAUS,yBAAgB;YAC5B;YACA;gBACEX,SAASU,gBAAU;gBACnBR,UAAUU,sBAAa;YACzB;YACA;gBACEZ,SAASU,gBAAU;gBACnBR,UAAUW,uBAAc;YAC1B;SACD;IACH;GACa5C"}