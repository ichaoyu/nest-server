{"version":3,"sources":["../../../src/shared/validators/is-not-empty-with.ts"],"sourcesContent":["import {\n  ValidationOptions,\n  buildMessage,\n  isNotEmpty,\n  registerDecorator,\n} from 'class-validator';\n\n/**\n * DTO 兄弟属性非空比较\n */\nexport function IsNotEmptyWith(\n  property: string,\n  validationOptions?: ValidationOptions,\n) {\n  return (object: unknown, propertyName: string) => {\n    registerDecorator({\n      name: 'IsNotEmptyWith',\n      target: object.constructor,\n      propertyName: propertyName,\n      constraints: [property],\n      options: validationOptions,\n      validator: {\n        validate(value, args) {\n          const [relatedPropertyName] = args.constraints;\n          const relatedValue = (args.object as any)[relatedPropertyName];\n\n          if (isNotEmpty(relatedValue)) {\n            return isNotEmpty(value);\n          }\n          return true;\n        },\n        defaultMessage: buildMessage(\n          (eachPrefix) =>\n            `${eachPrefix}$property should not empty with $constraint1`,\n          validationOptions,\n        ),\n      },\n    });\n  };\n}\n"],"names":["IsNotEmptyWith","property","validationOptions","object","propertyName","registerDecorator","name","target","constructor","constraints","options","validator","validate","value","args","relatedPropertyName","relatedValue","isNotEmpty","defaultMessage","buildMessage","eachPrefix"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAUgBA;;;eAAAA;;;gCALT;AAKA,SAASA,eACdC,QAAgB,EAChBC,iBAAqC;IAErC,OAAO,CAACC,QAAiBC;QACvBC,IAAAA,iCAAiB,EAAC;YAChBC,MAAM;YACNC,QAAQJ,OAAOK,WAAW;YAC1BJ,cAAcA;YACdK,aAAa;gBAACR;aAAS;YACvBS,SAASR;YACTS,WAAW;gBACTC,UAASC,KAAK,EAAEC,IAAI;oBAClB,MAAM,CAACC,oBAAoB,GAAGD,KAAKL,WAAW;oBAC9C,MAAMO,eAAe,AAACF,KAAKX,MAAM,AAAQ,CAACY,oBAAoB;oBAE9D,IAAIE,IAAAA,0BAAU,EAACD,eAAe;wBAC5B,OAAOC,IAAAA,0BAAU,EAACJ;oBACpB;oBACA,OAAO;gBACT;gBACAK,gBAAgBC,IAAAA,4BAAY,EAC1B,CAACC,aACC,CAAC,EAAEA,WAAW,4CAA4C,CAAC,EAC7DlB;YAEJ;QACF;IACF;AACF"}