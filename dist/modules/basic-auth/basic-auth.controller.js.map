{"version":3,"sources":["../../../src/modules/basic-auth/basic-auth.controller.ts"],"sourcesContent":["import {\n  Body,\n  Controller,\n  Get,\n  HttpStatus,\n  Post,\n  Render,\n  Res,\n} from '@nestjs/common';\nimport { ApiExcludeController } from '@nestjs/swagger';\n\nimport { EXTRAS } from '@/constants';\nimport { IResponse } from '@/interfaces';\nimport { HashUtil } from '@/utils';\n\nimport { BasicAuthLoginDTO } from './basic-auth.dto';\n\n@ApiExcludeController()\n@Controller(EXTRAS.BASIC_AUTH_PATH)\nexport class BasicAuthController {\n  @Get('/')\n  @Render('basic-auth')\n  index() {\n    return {};\n  }\n\n  @Post('/login')\n  async login(\n    @Body() dto: BasicAuthLoginDTO,\n    @Res({ passthrough: true }) res: IResponse,\n  ) {\n    const newVal = `${dto.userName}:${dto.password}`;\n\n    if (newVal === EXTRAS.BASIC_AUTH_RAW) {\n      const newHash = await HashUtil.crypto(newVal);\n\n      res.status(HttpStatus.OK);\n      res.setCookie(EXTRAS.BASIC_AUTH_KEY, newHash, {\n        path: '/',\n        httpOnly: true,\n        maxAge: 2 * 24 * 60 * 60,\n      });\n      return {};\n    }\n    res.status(HttpStatus.BAD_REQUEST);\n  }\n}\n"],"names":["BasicAuthController","index","login","dto","res","newVal","userName","password","EXTRAS","BASIC_AUTH_RAW","newHash","HashUtil","crypto","status","HttpStatus","OK","setCookie","BASIC_AUTH_KEY","path","httpOnly","maxAge","BAD_REQUEST","Get","Render","Post","Body","Res","passthrough","ApiExcludeController","Controller","BASIC_AUTH_PATH"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAmBaA;;;eAAAA;;;wBAXN;yBAC8B;2BAEd;4BACG;uBACD;8BAES;;;;;;;;;;;;;;;AAI3B,IAAA,AAAMA,sBAAN,MAAMA;IAGXC,QAAQ;QACN,OAAO,CAAC;IACV;IAEA,MACMC,MACJ,AAAQC,GAAsB,EAC9B,AAA4BC,GAAc,EAC1C;QACA,MAAMC,SAAS,CAAC,EAAEF,IAAIG,QAAQ,CAAC,CAAC,EAAEH,IAAII,QAAQ,CAAC,CAAC;QAEhD,IAAIF,WAAWG,iBAAM,CAACC,cAAc,EAAE;YACpC,MAAMC,UAAU,MAAMC,eAAQ,CAACC,MAAM,CAACP;YAEtCD,IAAIS,MAAM,CAACC,kBAAU,CAACC,EAAE;YACxBX,IAAIY,SAAS,CAACR,iBAAM,CAACS,cAAc,EAAEP,SAAS;gBAC5CQ,MAAM;gBACNC,UAAU;gBACVC,QAAQ,IAAI,KAAK,KAAK;YACxB;YACA,OAAO,CAAC;QACV;QACAhB,IAAIS,MAAM,CAACC,kBAAU,CAACO,WAAW;IACnC;AACF;;IA1BGC,IAAAA,WAAG,EAAC;IACJC,IAAAA,cAAM,EAAC;;;;GAFGvB;;IAOVwB,IAAAA,YAAI,EAAC;IAEHC,aAAAA,IAAAA,YAAI;IACJC,aAAAA,IAAAA,WAAG,EAAC;QAAEC,aAAa;IAAK;;;eADZ,+BAAiB,4BAAjB,+BAAiB;eACG,qBAAS,4BAAT,qBAAS;;;GAVjC3B;AAAAA;IAFZ4B,IAAAA,6BAAoB;IACpBC,IAAAA,kBAAU,EAACrB,iBAAM,CAACsB,eAAe;GACrB9B"}