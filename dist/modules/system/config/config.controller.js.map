{"version":3,"sources":["../../../../src/modules/system/config/config.controller.ts"],"sourcesContent":["import { CacheKey, CacheTTL } from '@nestjs/cache-manager';\nimport {\n  Body,\n  Controller,\n  Delete,\n  Get,\n  Post,\n  Put,\n  Query,\n} from '@nestjs/common';\nimport {\n  ApiBearerAuth,\n  ApiOkResponse,\n  ApiOperation,\n  ApiQuery,\n  ApiTags,\n} from '@nestjs/swagger';\n\nimport { CACHES, ENTITY_BIZ_TYPE } from '@/constants';\nimport { OperLog, Permission } from '@/decorators';\nimport { DelDTO, ExportResultVO } from '@/models';\n\nimport {\n  CreateConfigDTO,\n  FindConfigPageDTO,\n  UpdateConfigDTO,\n} from './config.dto';\nimport { ConfigService } from './config.service';\nimport { FindConfigPageVO, GetConfigValueVO } from './config.vo';\n\n@ApiTags('参数接口')\n@ApiBearerAuth()\n@Controller('/system/config')\nexport class ConfigController {\n  constructor(private configService: ConfigService) {}\n\n  @ApiOperation({ summary: '查询参数分页' })\n  @ApiOkResponse({ type: FindConfigPageVO })\n  @Permission('system:config:list')\n  @Post('/page')\n  async findPage(@Body() dto: FindConfigPageDTO) {\n    return await this.configService.handleFindPage(dto);\n  }\n\n  @ApiOperation({ summary: '获取参数值' })\n  @ApiOkResponse({ type: GetConfigValueVO })\n  @ApiQuery({ name: 'key', description: '参数键名' })\n  @Permission('system:config:list')\n  @CacheKey(CACHES.SYS_CONFIG_KEY)\n  @CacheTTL(15 * 1000)\n  @Get('/value')\n  async getValue(@Query('key') key: string) {\n    return await this.configService.handleGetValue(key);\n  }\n\n  @ApiOperation({ summary: '新增参数' })\n  @OperLog({ title: '参数配置', bizType: ENTITY_BIZ_TYPE.INSERT })\n  @Permission('system:config:add')\n  @Post('/create')\n  async create(@Body() dto: CreateConfigDTO) {\n    await this.configService.handleCreate(dto);\n  }\n\n  @ApiOperation({ summary: '更新参数' })\n  @ApiQuery({ name: 'id', description: '主键' })\n  @OperLog({ title: '参数配置', bizType: ENTITY_BIZ_TYPE.UPDATE })\n  @Permission('system:config:edit')\n  @Put('/update')\n  async update(@Query('id') id: string, @Body() dto: UpdateConfigDTO) {\n    await this.configService.handleUpdate(id, dto);\n  }\n\n  @ApiOperation({ summary: '删除参数' })\n  @OperLog({ title: '参数配置', bizType: ENTITY_BIZ_TYPE.DELETE })\n  @Permission('system:config:remove')\n  @Delete('/delete')\n  async deleteMany(@Body() dto: DelDTO) {\n    await this.configService.handleDeleteMany(dto);\n  }\n\n  @ApiOperation({ summary: '导出参数分页' })\n  @ApiOkResponse({ type: ExportResultVO })\n  @OperLog({ title: '参数配置', bizType: ENTITY_BIZ_TYPE.EXPORT })\n  @Permission('system:config:export')\n  @Post('/export')\n  async exportPage(@Body() dto: FindConfigPageDTO) {\n    return await this.configService.handleExportPage(dto);\n  }\n}\n"],"names":["ConfigController","findPage","dto","configService","handleFindPage","getValue","key","handleGetValue","create","handleCreate","update","id","handleUpdate","deleteMany","handleDeleteMany","exportPage","handleExportPage","constructor","ApiOperation","summary","ApiOkResponse","type","FindConfigPageVO","Permission","Post","Body","GetConfigValueVO","ApiQuery","name","description","CacheKey","CACHES","SYS_CONFIG_KEY","CacheTTL","Get","Query","OperLog","title","bizType","ENTITY_BIZ_TYPE","INSERT","UPDATE","Put","DELETE","Delete","ExportResultVO","EXPORT","ApiTags","ApiBearerAuth","Controller"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}