{"version":3,"sources":["../../../../src/modules/system/user/user.controller.ts"],"sourcesContent":["import {\n  Body,\n  Controller,\n  Delete,\n  Get,\n  Post,\n  Put,\n  Query,\n} from '@nestjs/common';\nimport {\n  ApiBearerAuth,\n  ApiBody,\n  ApiConsumes,\n  ApiOkResponse,\n  ApiOperation,\n  ApiQuery,\n  ApiTags,\n} from '@nestjs/swagger';\n\nimport { ENTITY_BIZ_TYPE } from '@/constants';\nimport { Files, OperLog, Permission } from '@/decorators';\nimport { IFiles } from '@/interfaces';\nimport { DelDTO, ExportResultVO, UploadFileDTO } from '@/models';\n\nimport {\n  CreateUserDTO,\n  FindUserPageDTO,\n  ResetPasswordDTO,\n  UpdateUserDTO,\n} from './user.dto';\nimport { UserService } from './user.service';\nimport {\n  FindUserPageVO,\n  GetUserAddFormDataVO,\n  GetUserEditFormDataVO,\n  ImportUserTemplateVO,\n} from './user.vo';\n\n@ApiTags('用户接口')\n@ApiBearerAuth()\n@Controller('/system/user')\nexport class UserController {\n  constructor(private userService: UserService) {}\n\n  @ApiOperation({ summary: '查询用户分页' })\n  @ApiOkResponse({ type: FindUserPageVO })\n  @Permission('system:user:list')\n  @Post('/page')\n  async findPage(@Body() dto: FindUserPageDTO) {\n    return await this.userService.handleFindPage(dto);\n  }\n\n  @ApiOperation({ summary: '获取用户新增表单数据' })\n  @ApiOkResponse({ type: GetUserAddFormDataVO })\n  @Permission('system:user:list')\n  @Get('/formAddData')\n  async getFormAddData() {\n    return await this.userService.handleGetFormData();\n  }\n\n  @ApiOperation({ summary: '获取用户编辑表单数据' })\n  @ApiOkResponse({ type: GetUserEditFormDataVO })\n  @ApiQuery({ name: 'id', description: '主键' })\n  @Permission('system:user:list')\n  @Get('/formEditData')\n  async getFormEditData(@Query('id') id: string) {\n    return await this.userService.handleGetFormData(id);\n  }\n\n  @ApiOperation({ summary: '新增用户' })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.INSERT })\n  @Permission('system:user:add')\n  @Post('/create')\n  async create(@Body() dto: CreateUserDTO) {\n    await this.userService.handleCreate(dto);\n  }\n\n  @ApiOperation({ summary: '更新用户' })\n  @ApiQuery({ name: 'id', description: '主键' })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.UPDATE })\n  @Permission('system:user:edit')\n  @Put('/update')\n  async updateUser(@Query('id') id: string, @Body() dto: UpdateUserDTO) {\n    await this.userService.handleUpdate(id, dto);\n  }\n\n  @ApiOperation({ summary: '删除用户' })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.DELETE })\n  @Permission('system:user:remove')\n  @Delete('/delete')\n  async deleteMany(@Body() dto: DelDTO) {\n    await this.userService.handleDeleteMany(dto);\n  }\n\n  @ApiOperation({ summary: '导入用户模板' })\n  @ApiOkResponse({ type: ImportUserTemplateVO })\n  @ApiConsumes('multipart/form-data')\n  @ApiBody({ description: '用户模板', type: UploadFileDTO })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.IMPORT })\n  @Permission('system:user:import')\n  @Post('/template/import')\n  async importTemplate(@Files() files: IFiles) {\n    return await this.userService.handleImportTemplate(files[0]);\n  }\n\n  @ApiOperation({ summary: '导出用户模板' })\n  @ApiOkResponse({ type: ExportResultVO })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.EXPORT })\n  @Permission('system:user:export')\n  @Post('/template/export')\n  async exportTemplate() {\n    return await this.userService.handleExportTemplate();\n  }\n\n  @ApiOperation({ summary: '导出用户分页' })\n  @ApiOkResponse({ type: ExportResultVO })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.EXPORT })\n  @Permission('system:user:export')\n  @Post('/page/export')\n  async exportPage(@Body() dto: FindUserPageDTO) {\n    return await this.userService.handleExportPage(dto);\n  }\n\n  @ApiOperation({ summary: '重置密码' })\n  @ApiQuery({ name: 'id', description: '主键' })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.UPDATE })\n  @Permission('system:user:edit')\n  @Put('/resetPassword')\n  async resetPassword(@Query('id') id: string, @Body() dto: ResetPasswordDTO) {\n    await this.userService.handleResetPassword(id, dto);\n  }\n\n  @ApiOperation({ summary: '切换用户状态' })\n  @ApiQuery({ name: 'id', description: '主键' })\n  @OperLog({ title: '用户管理', bizType: ENTITY_BIZ_TYPE.UPDATE })\n  @Permission('system:user:edit')\n  @Put('/toggleStatus')\n  async toggleStatus(@Query('id') id: string) {\n    await this.userService.handleToggleStatus(id);\n  }\n}\n"],"names":["UserController","findPage","dto","userService","handleFindPage","getFormAddData","handleGetFormData","getFormEditData","id","create","handleCreate","updateUser","handleUpdate","deleteMany","handleDeleteMany","importTemplate","files","handleImportTemplate","exportTemplate","handleExportTemplate","exportPage","handleExportPage","resetPassword","handleResetPassword","toggleStatus","handleToggleStatus","constructor","ApiOperation","summary","ApiOkResponse","type","FindUserPageVO","Permission","Post","Body","GetUserAddFormDataVO","Get","GetUserEditFormDataVO","ApiQuery","name","description","Query","OperLog","title","bizType","ENTITY_BIZ_TYPE","INSERT","UPDATE","Put","DELETE","Delete","ImportUserTemplateVO","ApiConsumes","ApiBody","UploadFileDTO","IMPORT","Files","ExportResultVO","EXPORT","ApiTags","ApiBearerAuth","Controller"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}